<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="utf-8" />
<meta name="viewport" content="width=device-width, initial-scale=1" />
<title>Toddler Flashcards – PWA</title>
<link rel="manifest" href="manifest.webmanifest">
<meta name="theme-color" content="#5b8ef9">
<meta name="apple-mobile-web-app-capable" content="yes">
<meta name="apple-mobile-web-app-status-bar-style" content="default">
<link rel="apple-touch-icon" href="assets/icon-192.png">
<style>
  :root {
    --bg: #f7f7fb;
    --ink: #0d0d0f;
    --muted: #6a6a75;
    --accent: #5b8ef9;
    --card: #ffffff;
    --shadow: 0 8px 24px rgba(0,0,0,.12);
    --radius: 20px;
  }
  * { box-sizing: border-box; }
  html, body { height: 100%; }
  body {
    margin: 0; background: var(--bg); color: var(--ink);
    font-family: system-ui, -apple-system, Segoe UI, Roboto, Helvetica, Arial;
    display: flex; flex-direction: column;
  }
  header { position: sticky; top: 0; background: var(--bg); padding: 12px 16px; box-shadow: 0 2px 16px rgba(0,0,0,.06); z-index: 5; }
  .row { display: flex; gap: 8px; flex-wrap: wrap; align-items: center; }
  .row > * { flex: 0 0 auto; }
  .title { font-weight: 800; font-size: 20px; }
  .spacer { flex: 1 1 auto; }
  .seg { display: inline-flex; background: #fff; border-radius: 12px; box-shadow: var(--shadow); overflow: hidden; }
  .seg button { border:0; background:#fff; padding:10px 14px; font-size:16px; cursor:pointer; user-select:none; }
  .seg button[aria-pressed="true"] { background: var(--accent); color:#fff; font-weight:700; }
  main { display: grid; place-items: center; padding: 18px; flex:1; }
  .stage { width:min(92vw,780px); }
  .card-wrap { perspective: 1200px; width:100%; aspect-ratio:3/4; position:relative; }
  .card { position:absolute; inset:0; transform-style:preserve-3d; transition:transform .6s cubic-bezier(.2,.8,.2,1); }
  .card.flipped { transform: rotateY(180deg); }
  .face { position:absolute; inset:0; display:grid; place-items:center; backface-visibility:hidden; border-radius:var(--radius); box-shadow:var(--shadow); padding:24px; }
  .front { background:var(--card); }
  .back { background:var(--card); transform: rotateY(180deg); }
  .big-text { font-size: clamp(56px,10vw,140px); font-weight:900; line-height:1; text-align:center; }
  .sub { font-size: clamp(22px,3.5vw,36px); color: var(--muted); margin-top:8px; text-align:center; }
  .emoji { font-size: clamp(64px,12vw,160px); line-height:1; }
  .controls { margin-top:16px; display:grid; grid-template-columns:repeat(6,1fr); gap:10px; }
  .controls button { font-size:15px; padding:12px 10px; }
  .wide { grid-column: span 2; }
  .tall { grid-column: span 3; }
  footer { padding:12px 18px; text-align:center; color: var(--muted); font-size:14px; }
</style>
</head>
<body>
<header>
  <div class="row">
    <div class="title" id="appTitle">Flashcards: Colors</div>
    <div class="spacer"></div>
    <div class="seg" role="group">
      <button data-mode="colors" aria-pressed="true">Colors</button>
      <button data-mode="letters" aria-pressed="false">Letters</button>
      <button data-mode="numbers" aria-pressed="false">Numbers</button>
      <button data-mode="shapes" aria-pressed="false">Shapes</button>
      <button data-mode="favorites" aria-pressed="false">Favorites</button>
    </div>
    <button id="muteBtn" aria-pressed="false" title="Toggle sound">🔊</button>
  </div>
</header>
<main>
  <div class="stage">
    <div class="card-wrap" id="cardWrap" tabindex="0" aria-live="polite">
      <div class="card" id="card">
        <div class="face front" id="front"></div>
        <div class="face back" id="back"></div>
      </div>
    </div>
    <div class="controls">
      <button id="prevBtn" class="wide">⟵ Prev</button>
      <button id="flipBtn" class="wide">Flip</button>
      <button id="nextBtn" class="wide">Next ⟶</button>
      <button id="shuffleBtn" class="wide">Shuffle</button>
      <button id="autoplayBtn" class="tall">Auto Play</button>
      <button id="fullscreenBtn" class="tall">Full Screen</button>
    </div>
  </div>
</main>
<footer>Tap the card to flip. Swipe or use buttons. Install from Safari via “Add to Home Screen”.</footer>

<script>
// Register Service Worker
if ('serviceWorker' in navigator) {
  window.addEventListener('load', function() {
    navigator.serviceWorker.register('./service-worker.js');
  });
}

(function(){
  const COLORS=[
    {name:"Red",hex:"#ff3b30",emoji:"🍎",object:"apple"},
    {name:"Blue",hex:"#007aff",emoji:"🚗",object:"car"},
    {name:"Yellow",hex:"#ffcc00",emoji:"🌞",object:"sun"},
    {name:"Green",hex:"#34c759",emoji:"🍀",object:"leaf"},
    {name:"Orange",hex:"#ff9500",emoji:"🍊",object:"orange"},
    {name:"Purple",hex:"#af52de",emoji:"🍇",object:"grapes"},
    {name:"Pink",hex:"#ff2d55",emoji:"🐷",object:"pig"},
    {name:"Brown",hex:"#8b5e3c",emoji:"🐻",object:"bear"},
    {name:"Black",hex:"#000000",emoji:"🐧",object:"penguin"},
    {name:"White",hex:"#ffffff",emoji:"⛄",object:"snowman"}
  ];
  const LETTERS=[
    {letter:"A",word:"Apple",emoji:"🍎"},{letter:"B",word:"Bear",emoji:"🐻"},{letter:"C",word:"Cat",emoji:"🐱"},
    {letter:"D",word:"Dog",emoji:"🐶"},{letter:"E",word:"Egg",emoji:"🥚"},{letter:"F",word:"Frog",emoji:"🐸"},
    {letter:"G",word:"Grapes",emoji:"🍇"},{letter:"H",word:"House",emoji:"🏠"},{letter:"I",word:"Ice cream",emoji:"🍨"},
    {letter:"J",word:"Juice",emoji:"🧃"},{letter:"K",word:"Kite",emoji:"🪁"},{letter:"L",word:"Lion",emoji:"🦁"},
    {letter:"M",word:"Moon",emoji:"🌙"},{letter:"N",word:"Nose",emoji:"👃"},{letter:"O",word:"Orange",emoji:"🍊"},
    {letter:"P",word:"Pig",emoji:"🐷"},{letter:"Q",word:"Queen",emoji:"👑"},{letter:"R",word:"Rainbow",emoji:"🌈"},
    {letter:"S",word:"Sun",emoji:"🌞"},{letter:"T",word:"Turtle",emoji:"🐢"},{letter:"U",word:"Umbrella",emoji:"☂️"},
    {letter:"V",word:"Violin",emoji:"🎻"},{letter:"W",word:"Whale",emoji:"🐳"},{letter:"X",word:"Xylophone",emoji:"🎼"},
    {letter:"Y",word:"Yarn",emoji:"🧶"},{letter:"Z",word:"Zebra",emoji:"🦓"}
  ];
  const NUMBERS=[
    {num:"1",word:"One dog",emoji:"🐶"},{num:"2",word:"Two fingers",emoji:"✌️"},{num:"3",word:"Three bananas",emoji:"🍌"},
    {num:"4",word:"Four cars",emoji:"🚗"},{num:"5",word:"Five stars",emoji:"⭐"},{num:"6",word:"Six fish",emoji:"🐟"},
    {num:"7",word:"Seven colors",emoji:"🌈"},{num:"8",word:"Eight legs",emoji:"🐙"},{num:"9",word:"Nine balloons",emoji:"🎈"},
    {num:"10",word:"Ten cookies",emoji:"🍪"}
  ];
  const SHAPES=[
    {shape:"Circle",emoji:"⚪"},{shape:"Square",emoji:"🟥"},{shape:"Triangle",emoji:"🔺"},{shape:"Star",emoji:"⭐"},
    {shape:"Heart",emoji:"❤️"},{shape:"Oval",emoji:"🥚"},{shape:"Diamond",emoji:"💎"},{shape:"Rectangle",emoji:"📱"}
  ];
  const FAVORITES=[
    {name:"Dog",emoji:"🐶"},{name:"Cat",emoji:"🐱"},{name:"Fire Truck",emoji:"🚒"},{name:"Airplane",emoji:"✈️"},
    {name:"Tractor",emoji:"🚜"},{name:"Elephant",emoji:"🐘"},{name:"Dinosaur",emoji:"🦖"},{name:"Teddy Bear",emoji:"🧸"}
  ];

  let mode=localStorage.getItem("mode")||"colors";
  let index=0; let flipped=false; let autoplay=null; let muted=(localStorage.getItem("muted")==="true");

  const appTitle=document.getElementById("appTitle");
  const front=document.getElementById("front"), back=document.getElementById("back"), card=document.getElementById("card");
  const cardWrap=document.getElementById("cardWrap");
  const segBtns=document.querySelectorAll(".seg button");
  const prevBtn=document.getElementById("prevBtn"), nextBtn=document.getElementById("nextBtn"),
        flipBtn=document.getElementById("flipBtn"), shuffleBtn=document.getElementById("shuffleBtn"),
        autoplayBtn=document.getElementById("autoplayBtn"), fullscreenBtn=document.getElementById("fullscreenBtn"),
        muteBtn=document.getElementById("muteBtn");

  function deck(){return mode==="colors"?COLORS:mode==="letters"?LETTERS:mode==="numbers"?NUMBERS:mode==="shapes"?SHAPES:FAVORITES;}
  function speak(txt){ if(muted) return; if(!("speechSynthesis" in window))return; try { let u=new SpeechSynthesisUtterance(txt); u.rate=0.9; window.speechSynthesis.cancel(); window.speechSynthesis.speak(u);}catch(e){} }
  function render(){
    const d=deck(); if(index<0) index=d.length-1; if(index>=d.length) index=0;
    const item=d[index]; card.classList.toggle("flipped",flipped);
    if(mode==="colors"){
      appTitle.textContent="Flashcards: Colors";
      document.querySelectorAll('.seg button').forEach(b=>b.setAttribute('aria-pressed', b.dataset.mode==='colors'?'true':'false'));
      front.style.background=item.hex; front.innerHTML=`<div class="big-text" style="color:${getTextColor(item.hex)}">${item.name}</div>`;
      back.style.background="var(--card)"; back.innerHTML=`<div class="emoji">${item.emoji}</div><div class="sub">${item.object}</div>`;
      speak(flipped?`${item.name}, ${item.object}`:item.name);
    }
    else if(mode==="letters"){
      appTitle.textContent="Flashcards: Letters";
      document.querySelectorAll('.seg button').forEach(b=>b.setAttribute('aria-pressed', b.dataset.mode==='letters'?'true':'false'));
      front.style.background="var(--card)"; front.innerHTML=`<div class="big-text">${item.letter}</div><div class="sub">${item.letter.toLowerCase()}</div>`;
      back.style.background="var(--card)"; back.innerHTML=`<div class="emoji">${item.emoji}</div><div class="sub">${item.word}</div>`;
      speak(flipped?`${item.letter} is for ${item.word}`:item.letter);
    }
    else if(mode==="numbers"){
      appTitle.textContent="Flashcards: Numbers";
      document.querySelectorAll('.seg button').forEach(b=>b.setAttribute('aria-pressed', b.dataset.mode==='numbers'?'true':'false'));
      front.style.background="var(--card)"; front.innerHTML=`<div class="big-text">${item.num}</div>`;
      back.style.background="var(--card)"; back.innerHTML=`<div class="emoji">${item.emoji}</div><div class="sub">${item.word}</div>`;
      speak(flipped?item.word:item.num);
    }
    else if(mode==="shapes"){
      appTitle.textContent="Flashcards: Shapes";
      document.querySelectorAll('.seg button').forEach(b=>b.setAttribute('aria-pressed', b.dataset.mode==='shapes'?'true':'false'));
      front.style.background="var(--card)"; front.innerHTML=`<div class="big-text">${item.shape}</div>`;
      back.style.background="var(--card)"; back.innerHTML=`<div class="emoji">${item.emoji}</div>`;
      speak(item.shape);
    }
    else {
      appTitle.textContent="Flashcards: Favorites";
      document.querySelectorAll('.seg button').forEach(b=>b.setAttribute('aria-pressed', b.dataset.mode==='favorites'?'true':'false'));
      front.style.background="var(--card)"; front.innerHTML=`<div class="big-text">${item.name}</div>`;
      back.style.background="var(--card)"; back.innerHTML=`<div class="emoji">${item.emoji}</div>`;
      speak(item.name);
    }
    muteBtn.textContent=muted?"🔇":"🔊";
  }

  function getTextColor(bgHex){
    const hex=bgHex.replace("#","");
    const r=parseInt(hex.substr(0,2),16); const g=parseInt(hex.substr(2,2),16); const b=parseInt(hex.substr(4,2),16);
    const yiq=(r*299+g*587+b*114)/1000;
    return yiq>=128?"#111111":"#ffffff";
  }

  // Controls & events
  document.querySelectorAll(".seg button").forEach(b=>b.addEventListener("click",()=>{mode=b.dataset.mode; localStorage.setItem("mode",mode); index=0; flipped=false; render();}));
  prevBtn.addEventListener("click",()=>{index--;flipped=false;render();});
  nextBtn.addEventListener("click",()=>{index++;flipped=false;render();});
  flipBtn.addEventListener("click",()=>{flipped=!flipped;render();});
  shuffleBtn.addEventListener("click",()=>{deck().sort(()=>Math.random()-0.5); index=0; flipped=false; render();});
  autoplayBtn.addEventListener("click",()=>{
    if(autoplay){ clearInterval(autoplay); autoplay=null; autoplayBtn.textContent="Auto Play"; }
    else { autoplay=setInterval(()=>{ index++; flipped=false; render(); }, 2500); autoplayBtn.textContent="Stop Auto"; }
  });
  fullscreenBtn.addEventListener("click",()=>{
    const el=document.documentElement;
    if(!document.fullscreenElement){ if(el.requestFullscreen) el.requestFullscreen(); }
    else { if(document.exitFullscreen) document.exitFullscreen(); }
  });
  muteBtn.addEventListener("click",()=>{ muted=!muted; localStorage.setItem("muted", muted?'true':'false'); render(); });
  cardWrap.addEventListener("click",()=>{ flipped=!flipped; render(); });

  // Swipe gestures
  let startX=null;
  cardWrap.addEventListener("touchstart",(e)=>{ if(e.touches.length===1) startX=e.touches[0].clientX; }, {passive:true});
  cardWrap.addEventListener("touchend",(e)=>{
    if(startX==null) return;
    const dx=e.changedTouches[0].clientX - startX;
    if(Math.abs(dx)>40){ if(dx<0){ index++; flipped=false; } else { index--; flipped=false; } render(); }
    startX=null;
  }, {passive:true});

  render();
})();
</script>
</body>
</html>
