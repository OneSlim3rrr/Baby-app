<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="utf-8" />
<meta name="viewport" content="width=device-width, initial-scale=1" />
<title>Toddler Flashcards ‚Äì PWA</title>
<link rel="manifest" href="manifest.webmanifest">
<meta name="theme-color" content="#5b8ef9">
<meta name="apple-mobile-web-app-capable" content="yes">
<meta name="apple-mobile-web-app-status-bar-style" content="default">
<link rel="apple-touch-icon" href="assets/icon-192.png">
<style>
body {
  font-family: "Comic Sans MS", "Fredoka One", sans-serif;
  background: #f0f9ff;
  display: flex;
  justify-content: center;
  align-items: center;
  height: 100vh;
  margin: 0;
}

.flashcard, .card {
  width: 90%;
  height: 70%;
  border-radius: 25px;
  box-shadow: 0 8px 16px rgba(0,0,0,0.2);
  display: flex;
  justify-content: center;
  align-items: center;
  font-size: 8rem;
  font-weight: bold;
  color: #333;
  transition: transform 0.4s ease, background 0.3s ease;
  cursor: pointer;
}

.card.flipped .front { display: none; }
.card.flipped .back { display: flex; }

.face.front, .face.back {
  position: absolute;
  width: 100%;
  height: 100%;
  border-radius: 25px;
  display: flex;
  justify-content: center;
  align-items: center;
  backface-visibility: hidden;
  transition: transform 0.4s;
}

.face.back { display: none; background: #fff; }

button {
  font-size: 2rem;
  border: none;
  background: #4cafef;
  color: white;
  border-radius: 50%;
  width: 80px;
  height: 80px;
  margin: 10px;
  box-shadow: 0 4px 10px rgba(0,0,0,0.2);
}

button:active { background: #0077cc; }
.big-text { font-size: 6rem; text-align: center; padding: 0 10px; }
</style>
</head>
<body>
<header>
  <div class="row">
    <div class="title" id="appTitle">Flashcards: Colors</div>
    <div class="spacer"></div>
    <div class="seg" role="group">
      <button data-mode="colors" aria-pressed="true">Colors</button>
      <button data-mode="letters" aria-pressed="false">Letters</button>
      <button data-mode="numbers" aria-pressed="false">Numbers</button>
      <button data-mode="shapes" aria-pressed="false">Shapes</button>
      <button data-mode="favorites" aria-pressed="false">Favorites</button>
    </div>
    <button id="muteBtn" aria-pressed="false" title="Toggle sound">üîä</button>
  </div>
</header>
<main>
  <div class="stage">
    <div class="card-wrap" id="cardWrap" tabindex="0" aria-live="polite">
      <div class="card" id="card">
        <div class="face front" id="front"></div>
        <div class="face back" id="back"></div>
      </div>
    </div>
    <div class="controls">
      <button id="prevBtn" class="wide">‚üµ Prev</button>
      <button id="flipBtn" class="wide">Flip</button>
      <button id="nextBtn" class="wide">Next ‚ü∂</button>
      <button id="shuffleBtn" class="wide">Shuffle</button>
      <button id="autoplayBtn" class="tall">Auto Play</button>
      <button id="fullscreenBtn" class="tall">Full Screen</button>
    </div>
  </div>
</main>
<footer>Tap the card to flip. Swipe or use buttons. Install from Safari via ‚ÄúAdd to Home Screen‚Äù.</footer>

<script>
// Register Service Worker
if ('serviceWorker' in navigator) {
  window.addEventListener('load', function() {
    navigator.serviceWorker.register('./service-worker.js');
  });
}

(function(){
  const COLORS=[
    {name:"Red",hex:"#ff3b30"},{name:"Blue",hex:"#007aff"},{name:"Yellow",hex:"#ffcc00"},
    {name:"Green",hex:"#34c759"},{name:"Orange",hex:"#ff9500"},{name:"Purple",hex:"#af52de"},
    {name:"Pink",hex:"#ff2d55"},{name:"Brown",hex:"#8b5e3c"},{name:"Black",hex:"#000000"},
    {name:"White",hex:"#ffffff"}
  ];
  const LETTERS=[
    {letter:"A",word:"Apple"},{letter:"B",word:"Bear"},{letter:"C",word:"Cat"},
    {letter:"D",word:"Dog"},{letter:"E",word:"Egg"},{letter:"F",word:"Frog"},
    {letter:"G",word:"Grapes"},{letter:"H",word:"House"},{letter:"I",word:"Ice cream"},
    {letter:"J",word:"Juice"},{letter:"K",word:"Kite"},{letter:"L",word:"Lion"},
    {letter:"M",word:"Moon"},{letter:"N",word:"Nose"},{letter:"O",word:"Orange"},
    {letter:"P",word:"Pig"},{letter:"Q",word:"Queen"},{letter:"R",word:"Rainbow"},
    {letter:"S",word:"Sun"},{letter:"T",word:"Turtle"},{letter:"U",word:"Umbrella"},
    {letter:"V",word:"Violin"},{letter:"W",word:"Whale"},{letter:"X",word:"Xylophone"},
    {letter:"Y",word:"Yarn"},{letter:"Z",word:"Zebra"}
  ];
  const NUMBERS=[
    {num:"1",word:"One"},{num:"2",word:"Two"},{num:"3",word:"Three"},
    {num:"4",word:"Four"},{num:"5",word:"Five"},{num:"6",word:"Six"},
    {num:"7",word:"Seven"},{num:"8",word:"Eight"},{num:"9",word:"Nine"},
    {num:"10",word:"Ten"}
  ];
  const SHAPES=[
    {shape:"Circle"},{shape:"Square"},{shape:"Triangle"},{shape:"Star"},
    {shape:"Heart"},{shape:"Oval"},{shape:"Diamond"},{shape:"Rectangle"}
  ];
  const FAVORITES=[
    {name:"Dog"},{name:"Cat"},{name:"Fire Truck"},{name:"Airplane"},
    {name:"Tractor"},{name:"Elephant"},{name:"Dinosaur"},{name:"Teddy Bear"}
  ];

  let mode=localStorage.getItem("mode")||"colors";
  let index=0; let flipped=false; let autoplay=null; let muted=(localStorage.getItem("muted")==="true");

  const appTitle=document.getElementById("appTitle");
  const front=document.getElementById("front"), back=document.getElementById("back"), card=document.getElementById("card");
  const cardWrap=document.getElementById("cardWrap");
  const prevBtn=document.getElementById("prevBtn"), nextBtn=document.getElementById("nextBtn"),
        flipBtn=document.getElementById("flipBtn"), shuffleBtn=document.getElementById("shuffleBtn"),
        autoplayBtn=document.getElementById("autoplayBtn"), fullscreenBtn=document.getElementById("fullscreenBtn"),
        muteBtn=document.getElementById("muteBtn");
  const segBtns=document.querySelectorAll(".seg button");

  function deck(){
    return mode==="colors"?COLORS:mode==="letters"?LETTERS:mode==="numbers"?NUMBERS:mode==="shapes"?SHAPES:FAVORITES;
  }

  function speak(txt){
    if(muted) return;
    if(!("speechSynthesis" in window)) return;
    try{
      let u=new SpeechSynthesisUtterance(txt);
      u.rate=0.7;
      window.speechSynthesis.cancel();
      window.speechSynthesis.speak(u);
    }catch(e){}
  }

  function render(){
    const d=deck(); 
    if(index<0) index=d.length-1;
    if(index>=d.length) index=0;
    const item=d[index];
    card.classList.toggle("flipped", flipped);

    // FRONT/BACK content
    if(mode==="colors"){
      front.style.background = item.hex;
      front.innerHTML="";
      back.style.background = "#fff";
      back.innerHTML=`<div class="big-text">${item.name}</div>`;
    } else if(mode==="letters"){
      front.style.background="#fff";
      front.innerHTML=`<div class="big-text">${item.letter}</div>`;
      back.style.background="#fff";
      back.innerHTML=`<div class="big-text">${item.word}</div>`;
    } else if(mode==="numbers"){
      front.style.background="#fff";
      front.innerHTML=`<div class="big-text">${item.num}</div>`;
      back.style.background="#fff";
      back.innerHTML=`<div class="big-text">${item.word}</div>`;
    } else if(mode==="shapes"){
      front.style.background="#fff";
      front.innerHTML=`<div class="big-text">${item.shape}</div>`;
      back.style.background="#fff";
      back.innerHTML=`<div class="big-text">${item.shape}</div>`;
    } else if(mode==="favorites"){
      front.style.background="#fff";
      front.innerHTML=`<div class="big-text">${item.name}</div>`;
      back.style.background="#fff";
      back.innerHTML=`<div class="big-text">${item.name}</div>`;
    }

    // Speech only when flipped
    if(flipped){
      if(mode==="colors"){ speak(item.name); }
      else if(mode==="letters"){ speak(`${item.letter} is for ${item.word}`); }
      else if(mode==="numbers"){ speak(item.word); }
      else if(mode==="shapes"){ speak(item.shape); }
      else if(mode==="favorites"){ speak(item.name); }
    }

    // Mute button display
    muteBtn.textContent=muted?"üîá":"üîä";

    // Update app title
    appTitle.textContent = "Flashcards: " + mode.charAt(0).toUpperCase() + mode.slice(1);
  }

  // Controls & events
  segBtns.forEach(b=>b.addEventListener("click",()=>{
    mode=b.dataset.mode; 
    localStorage.setItem("mode",mode);
    index=0; flipped=false;
    render();
    segBtns.forEach(btn=>btn.setAttribute("aria-pressed","false"));
    b.setAttribute("aria-pressed","true");
  }));

  prevBtn.addEventListener("click",()=>{index--; flipped=false; render();});
  nextBtn.addEventListener("click",()=>{index++; flipped=false; render();});
  flipBtn.addEventListener("click",()=>{flipped=!flipped; render();});
  shuffleBtn.addEventListener("click",()=>{deck().sort(()=>Math.random()-0.5); index=0; flipped=false; render();});
  autoplayBtn.addEventListener("click",()=>{
    if(autoplay){ clearInterval(autoplay); autoplay=null; autoplayBtn.textContent="Auto Play"; }
    else { autoplay=setInterval(()=>{ index++; flipped=false; render(); }, 2500); autoplayBtn.textContent="Stop Auto"; }
  });
  fullscreenBtn.addEventListener("click",()=>{
    const el=document.documentElement;
    if(!document.fullscreenElement){ if(el.requestFullscreen) el.requestFullscreen(); }
    else { if(document.exitFullscreen) document.exitFullscreen(); }
  });
  muteBtn.addEventListener("click",()=>{ muted=!muted; localStorage.setItem("muted", muted?'true':'false'); render(); });
  cardWrap.addEventListener("click",()=>{ flipped=!flipped; render(); });

  // Swipe gestures
  let startX=null;
  cardWrap.addEventListener("touchstart",(e)=>{ if(e.touches.length===1) startX=e.touches[0].clientX; }, {passive:true});
  cardWrap.addEventListener("touchend",(e)=>{
    if(startX==null) return;
    const dx=e.changedTouches[0].clientX - startX;
    if(Math.abs(dx)>40){ if(dx<0){ index++; flipped=false; } else { index--; flipped=false; } render(); }
    startX=null;
  }, {passive:true});

  render();
})();
</script>
</body>
</html>